/* --- Container & header --- */
.hids-section { display:flex; flex-direction:column; gap:1rem; }
.hids-header-row { display:flex; justify-content:space-between; align-items:center; gap:1rem; flex-wrap:wrap; }
.hids-title { margin:0; font-size:1.15rem; letter-spacing:0.4px; }
.hids-sub { margin:0; color:#9ca3af; font-size:0.9rem; }

/* Right controls */
.right-controls { display:flex; align-items:center; gap:0.8rem; }
.view-toggle { display:flex; border-radius:10px; overflow:hidden; background:transparent; border:1px solid rgba(148,163,184,0.06); }
.toggle-btn { padding:6px 10px; background:transparent; border:none; color:#9ca3af; cursor:pointer; font-size:0.85rem; }
.toggle-btn.active { background: rgba(148,163,184,0.06); color:#e5e7eb; box-shadow: inset 0 -4px 0 rgba(148,163,184,0.02); border-radius:6px; }

/* Status chip */
.status-text { margin-left:6px; font-size:0.78rem; padding:6px 10px; border-radius:999px; }
.status-chip::before{ content:""; display:inline-block; width:7px; height:7px; margin-right:6px; border-radius:50%; vertical-align:middle; }
.status-chip.normal { color:#e5e7eb; border:1px solid rgba(148,163,184,0.06); background:transparent; }
.status-chip.normal::before { background:#38bdf8; }
.status-chip.active { color:#bbf7d0; border:1px solid rgba(34,197,94,0.12); }
.status-chip.active::before { background:#22c55e; box-shadow:0 0 8px rgba(34,197,94,0.6); }
.status-chip.danger { color:#fecaca; border:1px solid rgba(239,68,68,0.08); }
.status-chip.danger::before { background:#ef4444; box-shadow:0 0 8px rgba(239,68,68,0.6); }

/* --- Flow: diagonal "stepped" layout --- */
.hids-flow { display:flex; align-items:flex-start; gap:1rem; flex-wrap:wrap; }

/* Stage columns */
.flow-stage { flex:1 1 220px; min-width:0; display:flex; flex-direction:column; gap:0.5rem; }
.stage-attacker { min-width:200px; }
.flow-stage-org { transform: translateX(12px); } /* organization slightly right */
.flow-stage-hids { transform: translate(24px, 12px); } /* HIDS slightly down-right */

/* Cards */
.hids-card { background:#020617; border-radius:10px; border:1px solid rgba(148,163,184,0.06); padding:10px; color:#e5e7eb; }
.card-top { display:flex; gap:0.6rem; align-items:center; }
.hids-avatar { width:40px; height:40px; border-radius:999px; display:flex; align-items:center; justify-content:center; background:#071029; border:1px solid rgba(148,163,184,0.08); font-size:20px; }
.hids-avatar-attacker { box-shadow: 0 0 12px rgba(239,68,68,0.35); }
.hids-card-title { font-weight:600; font-size:0.95rem; }
.hids-card-subtitle { font-size:0.78rem; color:#9ca3af; }
.hids-card-list.short { margin:8px 0 0; padding-left:14px; color:#cbd5f5; font-size:0.82rem; }

/* Hosts small nodes */
.hosts-row { display:flex; gap:8px; }
.hids-node-small { flex:1 1 0; min-width:0; background: rgba(12,18,28,0.9); border-radius:8px; border:1px solid rgba(80,92,116,0.12); padding:8px; display:flex; flex-direction:column; gap:6px; position:relative; }
.hids-node-icon { font-size:18px; }
.hids-node-title { font-size:0.86rem; font-weight:600; }
.hids-node-subtitle { font-size:0.72rem; color:#9ca3af; }

/* Agent badge */
.node-with-agent .agent-badge { position:absolute; top:6px; right:8px; font-size:14px; transform:translateZ(0); background: rgba(255,255,255,0.02); padding:3px; border-radius:6px; }

/* Agent to collector telemetry path (short) */
.agent-to-collector { position:absolute; left:50%; bottom:-12px; width:120px; height:8px; overflow:hidden; pointer-events:none; transform:translateX(-10%); }
.agent-to-collector.agent-active::before { content:""; position:absolute; left:0; right:0; top:50%; height:2px; background: linear-gradient(90deg, rgba(34,197,94,0.12), rgba(34,197,94,0.9)); transform:translateY(-50%); border-radius:999px; }
.agent-packet { position:absolute; left:-14px; top:-3px; width:10px; height:10px; border-radius:999px; background:#22c55e; box-shadow:0 0 10px rgba(34,197,94,0.9); animation:agentTravel 1.2s linear infinite; }
.agent-packet.fast { animation-duration:0.8s; }

/* --- Connectors: curved arc wrapper --- */
.connector-arc-wrap { display:flex; flex-direction:column; align-items:center; gap:6px; min-width:160px; }
.connector-path { position:relative; height:44px; width:100%; overflow:visible; }
.connector-arc::before { content:""; position:absolute; inset:0; border-radius:999px; border-top-width:2px; border-style:solid; border-bottom:none; opacity:0.95; transform-origin:center; }
.connector-normal::before { border-color: rgba(56,189,248,0.85); box-shadow:0 0 10px rgba(56,189,248,0.12); }
.connector-alert::before { border-color: rgba(239,68,68,0.95); box-shadow:0 0 14px rgba(239,68,68,0.14); }
.connector-telemetry::before { border-color: rgba(34,197,94,0.9); box-shadow:0 0 12px rgba(34,197,94,0.12); }

/* Reverse (visually Râ†’L) */
.connector-arc-reverse { transform: scaleX(-1); }

/* Packet that travels along arc */
.connector-packet { position:absolute; top:8px; left:-14px; width:10px; height:10px; border-radius:999px; animation:connectorTravel 2.4s linear infinite; }
.packet-normal { background:#38bdf8; box-shadow:0 0 10px rgba(56,189,248,0.9); }
.packet-alert { background:#ef4444; box-shadow:0 0 14px rgba(239,68,68,0.95); }
.packet-telemetry { background:#22c55e; box-shadow:0 0 12px rgba(34,197,94,0.95); }
.packet-bright { animation-duration:1.6s; }
.packet-fast { animation-duration:1.1s; }

/* Admin telemetry */
.admin-telemetry-line { position:relative; height:6px; border-radius:999px; background:linear-gradient(90deg, rgba(34,197,94,0.12), rgba(34,197,94,0.85)); overflow:hidden; margin-top:8px; }
.admin-telemetry-packet { position:absolute; left:-14px; top:-3px; width:10px; height:10px; border-radius:999px; background:#22c55e; box-shadow:0 0 12px rgba(34,197,94,0.95); animation:connectorTravel 2.5s linear infinite; }
.admin-telemetry-packet.bright { animation-duration:1.6s; }

/* Mini dashboard fills */
.mini-bar-row { display:flex; align-items:center; gap:8px; margin-top:6px; }
.mini-bar-label { min-width:64px; color:#9ca3af; font-size:12px; }
.mini-bar-track { flex:1; height:7px; background:rgba(20,30,40,0.7); border-radius:999px; overflow:hidden; }
.mini-bar-fill { height:100%; width:55%; border-radius:inherit; }
.mini-bar-fill.normal { background: linear-gradient(90deg,#38bdf8,#0ea5e9); }
.mini-bar-fill.active { background: linear-gradient(90deg,#22c55e,#4ade80); }
.mini-bar-fill.danger { background: linear-gradient(90deg,#ef4444,#f97373); width:40%; }
.mini-bar-fill.danger.pulse { animation:barPulse 1.3s infinite; }

/* Legend */
.hids-legend { display:flex; gap:12px; margin-top:8px; color:#9ca3af; font-size:13px; }
.legend-dot { width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:6px; }
.legend-normal { background:#38bdf8; }
.legend-telemetry { background:#22c55e; }
.legend-danger { background:#ef4444; }

/* Animations */
@keyframes connectorTravel { from { transform:translateX(0); } to { transform:translateX(calc(100% + 40px)); } }
@keyframes agentTravel { from { transform:translateX(0); } to { transform:translateX(calc(100% + 40px)); } }
@keyframes barPulse { 0% { width:25%; } 50% { width:75%; } 100% { width:25%; } }

/* Responsive tweaks */
@media (max-width:960px) {
  .hids-flow { flex-direction:column; }
  .flow-stage-org, .flow-stage-hids { transform:none; }
  .connector-arc-wrap { min-width:100%; }
  .hosts-row { flex-direction:column; }
}
